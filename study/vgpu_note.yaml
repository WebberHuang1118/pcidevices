System Paths:
    PCIDevicesRoot = "/sys/bus/pci/devices"
        e.q. /sys/bus/pci/devices/0000:08:00.0

    SysDevRoot                   = "/sys/bus/pci/devices/"
    MdevRoot                     = "/sys/bus/mdev/devices/"
    MdevBusClassRoot             = "/sys/class/mdev_bus/"

FetchVGPUStatus() Example
    From "MdevRoot"
        /sys/bus/mdev/devices/530aa168-dc58-49a5-85ee-f3ef45079304"
            -> /sys/devices/pci0000:00/0000:00:03.0/0000:08:00.4/530aa168-dc58-49a5-85ee-f3ef45079304

    /sys/devices/pci0000:00/0000:00:03.0/0000:08:00.4/3deab9a4-200a-4c54-99b1-5eb0722d1d81/mdev_type
        -> /sys/devices/pci0000:00/0000:00:03.0/0000:08:00.4/mdev_supported_types/nvidia-749

    ConfiguredVGPUTypeName:
        /sys/bus/pci/devices/0000:08:00.4/mdev_supported_types/nvidia-749/name

    fetchAvailableTypes()
        /sys/class/mdev_bus/0000:08:00.4/mdev_supported_types/nvidia-749

Enable VGPU Enable Example
    /sys/class/mdev_bus/0000:08:01.7/mdev_supported_types/nvidia-751/create

Disable
    /sys/class/mdev_bus/0000:08:01.7/3deab9a4-200a-4c54-99b1-5eb0722d1d81/remove

v1beta1.SRIOVGPUDevice Example:
  apiVersion: devices.harvesterhci.io/v1beta1
  kind: SRIOVGPUDevice
  metadata:
    labels:
      nodename: harvester-62vld
    name: harvester-62vld-000008000
    resourceVersion: "1357658"
    uid: 5742075e-cae0-42f3-b548-dcb54fa82f19
  spec:
    address: "0000:08:00.0"
    enabled: true
    nodeName: harvester-62vld
  status:
    vGPUDevices:
    - harvester-62vld-000008004
    - harvester-62vld-000008005
    - harvester-62vld-000008016
    - harvester-62vld-000008017
    - harvester-62vld-000008020
    - harvester-62vld-000008021
    - harvester-62vld-000008022
    - harvester-62vld-000008023
    - harvester-62vld-000008006
    - harvester-62vld-000008007
    - harvester-62vld-000008010
    - harvester-62vld-000008011
    - harvester-62vld-000008012
    - harvester-62vld-000008013
    - harvester-62vld-000008014
    - harvester-62vld-000008015
    vfAddresses:
    - "0000:08:00.4"
    - "0000:08:00.5"
    - "0000:08:01.6"
    - "0000:08:01.7"
    - "0000:08:02.0"
    - "0000:08:02.1"
    - "0000:08:02.2"
    - "0000:08:02.3"
    - "0000:08:00.6"
    - "0000:08:00.7"
    - "0000:08:01.0"
    - "0000:08:01.1"
    - "0000:08:01.2"
    - "0000:08:01.3"
    - "0000:08:01.4"
    - "0000:08:01.5"

v1beta1.VGPUDevice Example:
  Before enabled:
    apiVersion: devices.harvesterhci.io/v1beta1
    kind: VGPUDevice
    metadata:
      creationTimestamp: "2024-01-18T06:05:57Z"
      labels:
        harvesterhci.io/parentSRIOVGPUDevice: harvester-62vld-000008000
        nodename: harvester-62vld
        manager: pcidevices
        operation: Update
        subresource: status
      name: harvester-62vld-000008004
      uid: 83b1c8bb-9290-40a0-a0ab-0d8bc221b026
    spec:
      address: "0000:08:00.4"
      enabled: false
      nodeName: harvester-62vld
      parentGPUDeviceAddress: "0000:08:00.0"
      vGPUTypeName: ""
    status:
      availableTypes:
        NVIDIA A2-1A: nvidia-749
        NVIDIA A2-1B: nvidia-742
        NVIDIA A2-1Q: nvidia-744
        NVIDIA A2-2A: nvidia-750
        NVIDIA A2-2B: nvidia-743
        NVIDIA A2-2Q: nvidia-745
        NVIDIA A2-4A: nvidia-751
        NVIDIA A2-4C: nvidia-754
        NVIDIA A2-4Q: nvidia-746
        NVIDIA A2-8A: nvidia-752
        NVIDIA A2-8C: nvidia-755
        NVIDIA A2-8Q: nvidia-747
        NVIDIA A2-16A: nvidia-753
        NVIDIA A2-16C: nvidia-756
        NVIDIA A2-16Q: nvidia-748

  After enabled:
    apiVersion: devices.harvesterhci.io/v1beta1
    kind: VGPUDevice
    metadata:
      labels:
        harvesterhci.io/parentSRIOVGPUDevice: harvester-62vld-000008000
        nodename: harvester-62vld
      name: harvester-62vld-000008004
    spec:
      address: "0000:08:00.4"
      enabled: true
      nodeName: harvester-62vld
      parentGPUDeviceAddress: "0000:08:00.0"
      vGPUTypeName: NVIDIA A2-1A
    status:
      configureVGPUTypeName: NVIDIA A2-1A
      uuid: e44679e8-37dd-4258-a861-a7400f0d3571
      vGPUStatus: vGPUConfigured

Device Plugin Parameters:
  Kubevirt configuration:
    apiVersion: kubevirt.io/v1
    kind: KubeVirt
    metadata:
      name: kubevirt
      namespace: harvester-system
    spec:
      configuration:
        permittedHostDevices:
          mediatedDevices:
          - externalResourceProvider: true
            mdevNameSelector: NVIDIA A2-1A
            resourceName: nvidia.com/NVIDIA_A2-1A
      monitorAccount: rancher-monitoring-operator
      monitorNamespace: cattle-monitoring-system

  resourceName nvidia.com/NVIDIA_A2-1A
  SocketPath /var/lib/kubelet/device-plugins/kubevirt-nvidia.com-NVIDIA_A2-1A.sock
  resourceNameEnvVar MDEV_PCI_RESOURCE_nvidia_com_NVIDIA_A2-1A
  devicePath /sys/bus/mdev/devices/530aa168-dc58-49a5-85ee-f3ef45079304"


Trace Flow:
    Setup
        nodes.Register
        gpudevice.Register
        nodes.SetupNodeObjects

    reconcileNodeDevices
        gpuhelper.SetupSRIOVGPUDevices()
            gpuhelper.IdentifySRIOVGPU
            h.reconcileSRIOVGPUSetup

        gpuhelper.SetupVGPUDevices
            generateVGPUDevice
                FetchVGPUStatus
                    fetchAvailableTypes
            reconcileVGPUSetup

        pkg/controller/gpudevice/gpu_controller.go Register
            setupRemoteExecutor
                NewRemoteCommandExecutor
            OnGPUChange
                GenerateGPUStatus
                manageGPU
            OnVGPUChange
                FetchVGPUStatus
                enableVGPU
                    reconcileDisabledVGPUStatus
                disableVGPU
                    disableDevicePlugin
            reconcileEnabledVGPUPlugins
                createOrUpdateDevicePlugin
                    whiteListVGPU
                    NewVGPUDevicePlugin
                    startDevicePlugin
                        dp.Start
                (dp *VGPUDevicePlugin) Allocate
                (dp *VGPUDevicePlugin) ListAndWatch
                    healthCheck
                        performCheck
            OnVGPUChange
                disableVGPU
                    disableDevicePlugin
                    reconcileDisabledVGPUStatus

SRIOV GPU Example:
    P: /devices/pci0000:00/0000:00:03.0/0000:08:00.0
    L: virtfn0=../0000:08:00.4
    L: virtfn1=../0000:08:00.5
    L: virtfn10=../0000:08:01.6
    L: virtfn11=../0000:08:01.7
    L: virtfn12=../0000:08:02.0
    L: virtfn13=../0000:08:02.1
    L: virtfn14=../0000:08:02.2
    L: virtfn15=../0000:08:02.3
    L: virtfn2=../0000:08:00.6
    L: virtfn3=../0000:08:00.7
    L: virtfn4=../0000:08:01.0
    L: virtfn5=../0000:08:01.1
    L: virtfn6=../0000:08:01.2
    L: virtfn7=../0000:08:01.3
    L: virtfn8=../0000:08:01.4
    L: virtfn9=../0000:08:01.5

Example for VGPU Support Types:
    /sys/class/mdev_bus/0000:08:01.7/mdev_supported_types/nvidia-751/name: "NVIDIA A2-4A"
    /sys/class/mdev_bus/0000:08:01.7/mdev_supported_types/nvidia-742/name: "NVIDIA A2-1B"
    /sys/class/mdev_bus/0000:08:01.7/mdev_supported_types/nvidia-743/name: "NVIDIA A2-2B"

Unit Testing Logs: (from local branch "vgpu_log")
    === RUN   Test_IdentifySRIOVGPU
    time="2024-01-10T06:58:36Z" level=info msg="generated device: {{ } {mocknode-000008000      0 0001-01-01 00:00:00 +0000 UTC <nil> <nil> map[nodename:mocknode] map[] [] []  []} {0000:08:00.0 mocknode true} {[0000:08:00.4 0000:08:00.5 0000:08:01.6 0000:08:01.7 0000:08:02.0 0000:08:02.1 0000:08:02.2 0000:08:02.3 0000:08:00.6 0000:08:00.7 0000:08:01.0 0000:08:01.1 0000:08:01.2 0000:08:01.3 0000:08:01.4 0000:08:01.5] [mocknode-000008004 mocknode-000008005 mocknode-000008016 mocknode-000008017 mocknode-000008020 mocknode-000008021 mocknode-000008022 mocknode-000008023 mocknode-000008006 mocknode-000008007 mocknode-000008010 mocknode-000008011 mocknode-000008012 mocknode-000008013 mocknode-000008014 mocknode-000008015]}}"
    --- PASS: Test_IdentifySRIOVGPU (0.20s)


    === RUN   Test_fetchAvailableTypes
    time="2024-01-10T06:58:36Z" level=info msg="vGPUTypesDir: testdata/sys/class/mdev_bus/0000:08:01.7/mdev_supported_types"
    time="2024-01-10T06:58:36Z" level=info msg="availableTypes: map[NVIDIA A2-4A:nvidia-751 NVIDIA A2-4C:nvidia-754 NVIDIA A2-4Q:nvidia-746]"
    --- PASS: Test_fetchAvailableTypes (0.00s)


    === RUN   Test_fetchVGPUStatus
    time="2024-01-10T06:58:36Z" level=info msg="checking path /tmp/umockdev.GIH9G2/sys/bus/mdev/devices"
    time="2024-01-10T06:58:36Z" level=info msg="checking path /tmp/umockdev.GIH9G2/sys/bus/mdev/devices/3deab9a4-200a-4c54-99b1-5eb0722d1d81"
    time="2024-01-10T06:58:36Z" level=info msg="resolvedSymLink /tmp/umockdev.GIH9G2/sys/devices/pci0000:00/0000:00:03.0/0000:08:00.6/3deab9a4-200a-4c54-99b1-5eb0722d1d81"
    time="2024-01-10T06:58:36Z" level=info msg="checking path /tmp/umockdev.GIH9G2/sys/bus/mdev/devices/c728e022-f16f-434b-ad2c-9665ee634d3d"
    time="2024-01-10T06:58:36Z" level=info msg="resolvedSymLink /tmp/umockdev.GIH9G2/sys/devices/pci0000:00/0000:00:03.0/0000:08:02.0/c728e022-f16f-434b-ad2c-9665ee634d3d"
    time="2024-01-10T06:58:36Z" level=info msg="checking path /tmp/umockdev.GIH9G2/sys/bus/mdev/devices/f715f63c-0d00-4007-9c5a-b07b0c6c05de"
    time="2024-01-10T06:58:36Z" level=info msg="resolvedSymLink /tmp/umockdev.GIH9G2/sys/devices/pci0000:00/0000:00:03.0/0000:08:00.4/f715f63c-0d00-4007-9c5a-b07b0c6c05de"
    time="2024-01-10T06:58:36Z" level=info msg="vGPUTypesDir: testdata/sys/class/mdev_bus/0000:08:01.7/mdev_supported_types"
    time="2024-01-10T06:58:36Z" level=info msg="availableTypes: map[NVIDIA A2-4A:nvidia-751 NVIDIA A2-4C:nvidia-754 NVIDIA A2-4Q:nvidia-746]"
    time="2024-01-10T06:58:36Z" level=info msg="status &{   map[NVIDIA A2-4A:nvidia-751 NVIDIA A2-4C:nvidia-754 NVIDIA A2-4Q:nvidia-746]}"
    --- PASS: Test_fetchVGPUStatus (0.00s)


    === RUN   Test_GenerateDeviceName
        gpuhelper_test.go:53: nvidia.com/NVIDIA_A2-4C
    --- PASS: Test_GenerateDeviceName (0.00s)
